% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_vector_stats_kmers.R
\name{get_vector_stats_kmers}
\alias{get_vector_stats_kmers}
\title{Generate statistics about the kmers included in the RNAseq files}
\usage{
get_vector_stats_kmers(v_kmers_stats, vector_genome_path)
}
\arguments{
\item{v_kmers_stats}{A `data.frame` (or `tibble`) containing k-mer statistics,
which will be enriched by this function. It MUST include a column named
`Kmer` (type `character`) with the k-mers to be analyzed. Additionally,
it MUST contain `mean_freq_virus`, `mean_count`, and
`max_max_log10_segm_size` columns (type `numeric`), which are used
to calculate the `Enrichment_score` and `Distribution_score`.}

\item{vector_genome_path}{A `character` vector where each element is the
BASE PATH (filename without `_1.fastq` or `_2.fastq` suffix) for
a pair of paired-end FASTQ files. For example, if your files are
`sampleA_1.fastq` and `sampleA_2.fastq`, the corresponding element in
this vector should be `'path/to/sampleA'`. The function expects both
`_1.fastq` and `_2.fastq` files to exist for each base path. These files
contain the RNA sequences (e.g., mosquito RNA sequences).}
}
\value{
A `data.frame` (or `tibble`) that builds upon the input `v_kmers_stats`.
  It includes the following new columns for each k-mer and each input FASTQ file pair:
  \itemize{
    \item `kmer_count`: The total number of times the k-mer appeared across
      both `_1.fastq` and `_2.fastq` reads for a given sample.
    \item `freq_vector`: The frequency of the k-mer (k-mer count divided
      by total sequence length) in the FASTQ files for a given sample.
    \item `accession_id`: The base name of the FASTQ file pair (e.g., 'sampleA'
      from 'path/to/sampleA').
    \item `Enrichment_score`: Calculated as `mean_freq_virus / freq_vector`.
    \item `Distribution_score`: Calculated as `mean_count / max_max_log10_segm_size`.
  }
}
\description{
Calculates the count and frequency of specified k-mers within
  RNA-seq data from paired-end FASTQ files, enriching a provided k-mer
  statistics dataframe.

  Documentation has been partially AI generated
}
\details{
This function processes paired-end FASTQ files, expecting them to be named
with `_1.fastq` and `_2.fastq` suffixes (e.g., `sample_A_1.fastq`,
`sample_A_2.fastq`). The `vector_genome_path` parameter should provide
the base path *without* these suffixes.

For each k-mer in `v_kmers_stats$Kmer` and each pair of FASTQ files,
the function concatenates all reads from both files and calculates the
k-mer's total count and its frequency (count / total sequence length).

The `Enrichment_score` and `Distribution_score` are calculated using
pre-existing columns from the input `v_kmers_stats` dataframe:
`mean_freq_virus`, `mean_count`, and `max_max_log10_segm_size`.
Ensure these columns are present and contain relevant data from
your viral genome analysis.

This function relies on `ShortRead::readFastq` and `stringr::str_count`.
}
