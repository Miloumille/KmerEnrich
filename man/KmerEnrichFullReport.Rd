% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KmerEnrichFullReport.R
\name{KmerEnrichFullReport}
\alias{KmerEnrichFullReport}
\title{Generate an HTML report}
\usage{
KmerEnrichFullReport(
  virus_genome_path,
  vector_genome_path,
  k_list,
  x,
  report_name = "report"
)
}
\arguments{
\item{virus_genome_path}{A string specifying the path to a FASTA file or a folder containing multiple FASTA files representing the virus genome(s). K-mers will be searched within these sequences.}

\item{vector_genome_path}{A string specifying the path to a FASTA file or a folder containing multiple FASTA files representing the vector genome(s). K-mer frequencies in the vector genome are used for enrichment calculations.}

\item{k_list}{A numeric vector or list of integers, where each integer represents a k-mer length. The report will process and display results for k-mers of these specified lengths.}

\item{x}{An integer value indicating the number of first bases (prefix length) in each virus genome within which k-mers will be initially searched for the `common_kmers` step. Only k-mers found in this prefix across *all* virus genomes (if multiple are provided) are considered.}

\item{report_name}{A string specifying the base name for the generated HTML report file and the report's containing directory. The default is "report".}
}
\value{
This function primarily generates an HTML report and associated CSV files in a newly created dated directory within the working directory. It does not return an R object directly.
}
\description{
The `KmerEnrichFullReport` function executes the KmerEnrich pipeline and generates a comprehensive HTML report from an R Markdown template included within the package. This report summarizes the characteristics of identified k-mers within the virus and vector genomes, visualizes k-mer enrichment, and plots k-mer positions across virus genomes.

  Documentation has been partially AI generated
}
\details{
This function orchestrates several steps of the KmerEnrich pipeline:
\enumerate{
  \item \strong{K-mer Identification and Statistics:} For each `k` in `k_list`:
    \itemize{
      \item `common_kmers`: Identifies k-mers of length `k` that are present in the first `x` bases of all virus genomes specified by `virus_genome_path`.
      \item `kmers_pos_df`: Determines the positions of these common k-mers within all virus genomes.
      \item `get_virus_stats_kmers`: Calculates statistical properties for these k-mers based on their distribution and counts within the virus genomes.
      \item `get_vector_stats_kmers`: Incorporates k-mer frequency data from the `vector_genome_path` to compute enrichment scores. The results for each `k` are stored in the `results` list, accessible as `results[[paste0("k_", k)]]`. Each element of this list is a data frame containing columns like `Kmer`, `mean_count`, `sd_count`, `Distribution_score`, and `Enrichment_score`.
    }
  \item \strong{K-mer Position Data for Plotting:} For each `k` in `k_list`, the top 5 k-mers (based on `Distribution_score`) from the `results` data frame for that `k` are selected. For each of these top k-mers, their exact genomic positions across *all* virus genomes are identified. This data is structured and stored in the `plot_data` list. Each entry in `plot_data` (keyed by the k-mer sequence, e.g., "CATGG") contains:
    \itemize{
      \item `result`: The full statistical table (`complete_kmer_stats`) for the k-mer's length.
      \item `kmer`: The k-mer sequence itself.
      \item `kmer_positions`: A data frame with `Position` and `Genome` columns indicating where the k-mer was found.
      \item `Kmer_size`: The length of the k-mer.
    }
  \item \strong{Report Generation and Output:}
    \itemize{
      \item A dated subdirectory is created within a "reports" folder (e.g., `reports/report_20250607_183000`) to store all output files.
      \item For each `k` in `k_list`, the complete k-mer results (`results[[paste0("k_", k)]]`) are saved as a CSV file (e.g., `kmer_results_k5.csv`) within this directory.
      \item An HTML report (`report_name.html`) is rendered into the same dated directory using the internal R Markdown template. This report includes:
        \itemize{
          \item A table of the top 5 k-mers by `Enrichment_score` for each `k`.
          \item A scatter plot visualizing the `Distribution_score` (x-axis: "count per virus / sd segm virus") against the `Enrichment_score` (y-axis: "log10(frequency virus) - log10(frequency mos)") for all k-mers for each `k`. K-mers are connected by dashed grey lines, and points are colored by `accession_id`.
          \item Individual plots showing the genomic positions of the top 5 k-mers (from `plot_data`) across different virus genomes. The subtitle for these plots attempts to include an "Experiment" name, which would ideally be a descriptive string related to the analysis run.
        }
    }
}
}
